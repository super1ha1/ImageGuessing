{"version":3,"sources":["angular-clock.min.js"],"names":["clock","$interval","$filter","restrict","scope","gmtOffset","digitalFormat","template","link","element","attrs","stopTime","o","undefined","showDigital","showAnalog","showGmtInfo","startTime","parseInt","theme","gmtInfo","date","getDate","digital","analog","majors","Array","minors","tick","isNaN","timeText","$watch","value","getGMTbase100","getGMTText","on","cancel","offset","parseFloat","f","Math","floor","ceil","s","round","lpad","rpad","substring","num","now","Date","utc","getTime","getTimezoneOffset","offsetNow","hrs","getHours","mins","getMinutes","secs","getSeconds","d","format","timezone","angular","module","directive"],"mappings":"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","file":"angular-clock.min.js","sourcesContent":["(function() {\r\n  'use strict';\r\n\r\n  /* <ds-widget-clock data-gmt-offset=\"0\"></ds-widget-clock> */\r\n  var days = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];\r\n  var months = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];\r\n\r\n  angular.module('ds.clock', [])\r\n    .directive('dsWidgetClock', ['$interval', '$filter',\r\n      function($interval, $filter) {\r\n        return clock($interval, $filter);\r\n      }\r\n    ]);\r\n\r\n  function clock($interval, $filter) {\r\n    return {\r\n      restrict: 'EA',\r\n      scope: {\r\n        gmtOffset: '=gmtOffset',\r\n        digitalFormat: '=digitalFormat'\r\n      },\r\n      template: '<div class=\"widget-clock\" ng-class=\"theme\" ng-if=\"date\"><div class=\"digital\" ng-if=\"digital\"><span class=\"time\"><span class=\"hours\">{{digital}}</span></span></div><div class=\"analog\" ng-if=\"analog\"><div class=\"square\"><svg viewBox=\"0 0 100 100\"><g transform=\"translate(50,50)\"><circle class=\"clock-face\" r=\"48\" /><line ng-repeat=\"minor in minors track by $index\" class=\"minor\" y1=\"42\" y2=\"45\" ng-attr-transform=\"rotate({{360 * $index / minors.length}})\" /><line ng-repeat=\"major in majors track by $index\" class=\"major\" y1=\"35\" y2=\"46\" ng-attr-transform=\"rotate({{360 * $index / majors.length}})\" /><line class=\"hour\" y1=\"2\" y2=\"-20\" ng-attr-transform=\"rotate({{30 * date.hrs + date.mins / 2}})\" /><line class=\"minute\" y1=\"4\" y2=\"-30\" ng-attr-transform=\"rotate({{6 * date.mins + date.secs / 10}})\" /><g ng-attr-transform=\"rotate({{6 * date.secs}})\"><line class=\"second\" y1=\"10\" y2=\"-38\" /><line class=\"second-counterweight\" y1=\"10\" y2=\"2\" /></g></g></svg></div></div><div ng-if=\"gmtInfo\" class=\"gmt-info\">{{gmtInfo}}</div></div>',\r\n      link: function(scope, element, attrs) {\r\n        var format, // date format\r\n          stopTime; // so that we can cancel the time updates\r\n        var o = {}; //angular.copy(defaults)\r\n        var gmtOffset = scope.gmtOffset;\r\n        var digitalFormat = scope.digitalFormat !== undefined ? scope.digitalFormat : 'HH:mm:ss';\r\n        //o.gmtOffset = (gmtOffset !== undefined && gmtOffset !== null) ? parseFloat(gmtOffset) : false;\r\n        //o.showSecs = attrs.hideSecs !== undefined ? false : true;\r\n        //o.showAmPm = attrs.showAmPm !== undefined ? true : false;\r\n        o.showDigital = attrs.showDigital !== undefined ? true : false;\r\n        o.showAnalog = attrs.showAnalog !== undefined ? true : false;\r\n        o.showGmtInfo = attrs.showGmtInfo !== undefined ? true : false;\r\n        o.startTime = parseInt(attrs.startTime, 10); // ms\r\n        scope.theme = attrs.theme !== undefined ? attrs.theme : 'light';\r\n        if (!o.showDigital && !o.showAnalog) {\r\n          o.showAnalog = true;\r\n          o.showDigital = true;\r\n        }\r\n        scope.gmtInfo = false;\r\n\r\n        scope.date = getDate(o);\r\n\r\n        scope.digital = o.showDigital ? 'Loading..' : false;\r\n        scope.analog = o.showAnalog;\r\n        scope.majors = new Array(12);\r\n        scope.minors = new Array(60);\r\n        var date = null;\r\n        var tick = function() {\r\n          if (!isNaN(o.startTime)) {\r\n            o.startTime = o.startTime + 1000;\r\n          }\r\n          date = getDate(o);\r\n          scope.date = date;\r\n          if (o.showDigital) {\r\n            scope.digital = timeText(date, digitalFormat, gmtOffset, $filter);\r\n          }\r\n        };\r\n\r\n        stopTime = $interval(tick, 1000);\r\n        // watch the expression, and update the UI on change.\r\n        scope.$watch('gmtOffset', function(value) {\r\n          gmtOffset = value;\r\n          o.gmtOffset = (gmtOffset !== undefined && gmtOffset !== null) ? getGMTbase100(gmtOffset) : false;\r\n          if (o.showGmtInfo && o.gmtOffset !== false) {\r\n            scope.gmtInfo = getGMTText(o.gmtOffset);\r\n          }\r\n          tick();\r\n        });\r\n        /*scope.$watch('digitalFormat', function(value) {\r\n          digitalFormat = value;\r\n        });*/\r\n        // listen on DOM destroy (removal) event, and cancel the next UI update\r\n        // to prevent updating time after the DOM element was removed.\r\n        element.on('$destroy', function() {\r\n          $interval.cancel(stopTime);\r\n          stopTime = null;\r\n        });\r\n\r\n      }\r\n    };\r\n  }\r\n\r\n  function getGMTbase100(offset) {\r\n    offset = parseFloat(offset);\r\n    var f = offset > 0 ? Math.floor(offset) : Math.ceil(offset),\r\n      s = (offset % 1) / 0.6;\r\n\r\n    return f + s;\r\n\r\n  }\r\n\r\n  function getGMTbase60(offset) {\r\n    var f = offset > 0 ? Math.floor(offset) : Math.ceil(offset),\r\n      s = ((offset > 0 ? offset : offset * -1) % 1) * 60;\r\n    return f + s;\r\n\r\n  }\r\n\r\n  function getGMTText(offset) {\r\n\r\n    var f = offset > 0 ? Math.floor(offset) : Math.ceil(offset),\r\n      s = Math.round(((offset > 0 ? offset : offset * -1) % 1) * 60);\r\n\r\n    return 'GMT' + (offset === 0 ? '' : ((offset > 0 ? ' +' : ' ') + lpad(f) + '.' + rpad(s).substring(0, 2)));\r\n\r\n  }\r\n\r\n  function lpad(num) {\r\n    if (num < 0) {\r\n      return (num > -10 ? '-0' : '-') + (num * -1);\r\n    } else {\r\n      return (num < 10 ? '0' : '') + num;\r\n    }\r\n\r\n  }\r\n\r\n  function rpad(num) {\r\n    return num + (num < 10 ? '0' : '');\r\n  }\r\n  // Checkfor offset and get correct time\r\n  function getDate(o) {\r\n    var now = (!isNaN(o.startTime)) ? new Date(o.startTime) : new Date();\r\n    if (o.gmtOffset !== null && o.gmtOffset !== false) {\r\n      // Use GMT + gmtOffset\r\n      // convert to msec\r\n      // add local time zone offset\r\n      // get UTC time in msec\r\n      var utc = now.getTime() + (now.getTimezoneOffset() * 60000);\r\n      // create new Date object for different city\r\n      // using supplied offset\r\n      var offsetNow = new Date(utc + (3600000 * o.gmtOffset));\r\n      return {\r\n        hrs: offsetNow.getHours(),\r\n        mins: offsetNow.getMinutes(),\r\n        secs: offsetNow.getSeconds(),\r\n        date: offsetNow\r\n      };\r\n    } else {\r\n      // Use local time\r\n      return {\r\n        hrs: now.getHours(),\r\n        mins: now.getMinutes(),\r\n        secs: now.getSeconds(),\r\n        date: now\r\n      };\r\n    }\r\n  }\r\n\r\n  function timeText(d, format, timezone, $filter) {\r\n    return $filter('date')(d.date, format, timezone);\r\n    /*return '' +\r\n      (o.showAmPm ? ((d.hrs % 12) === 0 ? 12 : (d.hrs % 12)) : d.hrs) + ':' +\r\n      lpad(d.mins) +\r\n      (o.showSecs ? ':' + lpad(d.secs) : '') +\r\n      (o.showAmPm ? (d.hrs < 12 ? ' AM' : ' PM') : '');*/\r\n  }\r\n\r\n})();\r\n"],"sourceRoot":"/source/"}